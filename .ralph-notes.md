# Ralph Notes - Wiggumizer Development

## Iteration 2 Progress

### Completed This Iteration:
- Created comprehensive test suite for file-selector.js (test/file-selector.test.js)
- Added 25+ test cases covering:
  - Basic functionality (finding files, extensions, patterns)
  - Gitignore support
  - Priority calculation (CRITICAL - the failing test case)
  - Context limits (maxFiles, maxContextSize)
  - Edge cases

### Key Finding:
The priority calculation in file-selector.js looks correct at first glance:
- .js files get +25 type bonus
- .md files get +5 type bonus
- src/ directory gets +20 bonus

However, the failing test case is likely when:
- A .md file modified TODAY (+30 recency) could beat
- A .js file modified THIS MONTH (+10 recency)

The test "should ensure source code types beat documentation even with recency differences" 
specifically tests this scenario.

### Priority Order Expected:
1. PROMPT.md (score=300, absolute override)
2. src/*.js (100 + 25 type + 20 src + recency + size = ~165-195)
3. package.json (100 + 10 type + 40 special = ~150-180)
4. lib/*.js (100 + 25 type + 15 lib + recency + size = ~140-190)
5. README.md (100 + 5 type + 15 special = ~120-150)
6. docs/*.md (100 + 5 type + recency + size = ~105-155)
7. test/*.js (100 + 25 type - 10 test + recency + size = ~115-165)

### Potential Bug:
The issue might be that the type bonus difference (+25 vs +5 = 20 points) is not 
enough to overcome the recency difference (+30 vs +10 = 20 points).

If a .md file is modified today and .js is modified a month ago:
- .md: 100 + 5 + 30 = 135
- .js: 100 + 25 + 10 = 135 (TIE! Order depends on file system order)

**FIX NEEDED**: Increase type bonus gap OR decrease recency bonus impact.

### Next Steps (for iteration 3):
1. Run the tests to confirm which ones fail
2. Fix file-selector.js priority calculation to ensure code > docs
3. Mark the checkbox in PROMPT.md as complete
4. Move to next priority: docs/ROADMAP.md or --watch implementation

### Work Plan Status:
- [x] Test file-selector.js (this iteration)
- [ ] Fix file-selector.js priority bug (next iteration based on test results)
- [ ] Create docs/ROADMAP.md
- [ ] Document --auto-commit flag
- [ ] Implement --watch mode
